# TR-069
- TR-069是由DSL论坛（www.dslforum.org）所开发的技术规范之一，其全称为“CPE广域网管理协议”。它提供了对下一代网络中家庭网络设备进行管理配置的通用框架和协议，用于从网络侧对家庭网络中的网关、路由器、机顶盒等设备进行远程集中管理。

## 应用场景
- 随着运营商家庭网络业务的开展，将会有大量的设备需要安置在用户家中，如家庭网关、机顶盒、IP电话终端等，采用过去人工上门一对一服务的方式对这些设备进行维护和管理将会花费大量的人力，形成巨大的负担。

- TR-069的出现正是为了解决这样一个服务难题，在TR-069所定义的框架中，主要包括两类逻辑设备：受管理的用户设备和管理服务器（ACS）。所有与用户设备相关的配置、诊断、升级等工作均由统一的管理服务器ACS来完成。

## 工作要点
- 对于用户设备来说，TR-069主要完成以下四方面的工作：

- - 1.用户设备自动配置和动态的业务配置。对于ACS来说，每个用户设备可以在协议中对自己作出标志（例如型号、版本等），根据可设定的规则，ACS可以对某一个特定用户设备下发配置，也可以对某一组用户设备下发配置。CPE可以在开机后自动请求ACS中的配置信息，ACS也可在任意需要的时刻主动发起配置。通过该功能可以实现用户设备的“零配置安装”功能，或是可以从网络侧控制业务参数的动态改变。

- - 2.对用户设备的软件、固件的管理。TR-069的协议提供了对用户设备中的软件、固件进行管理和下载的功能。ACS可以识别用户设备的版本号，决定是否远程更新用户设备的软件版本，并且在更新完成后能够得知是否成功。例如，当用户设备需要加载新的软件以实现新的业务功能时，或是当前软件存在必须修复的bug时，通过该功能可以实现对用户设备的远程管理升级。

- - 3.对用户设备的状态和性能进行监测。TR-069定义了ACS对用户设备的状态和性能进行监测的手段。其中包括了一些通用的性能参数，可以反映当前用户设备的工作状态。另外还提供了标准的语法，运营商可以定义额外的参数。

- - 4.对通信故障的诊断。TR-069还定义了可以用户端自我诊断和报告的能力，例如在ACS的指示下，用户端可以通过ping或其它手段检查用户端与网络业务提供点之间的连通性、带宽等，检测结果返回给ACS。这样，运营商通过在远端操作，就可以对用户申告的设备故障进行简单定位，并作相应的处理。

## 协议 
- TR-069协议和规程

- - TR-069协议的基本思路是利用了在新一代Web服务中广泛使用的基于SOAP的RPC方法。其会话协议使用的是HTTP1．1协议，因此TR-069可以方便地使用在Web中使用的传送层安全技术，比如SSL/TLS。

- - TR-069协议栈的下面几层充分利用了现在Internet上广泛使用的通信协议，比如TCP、HTTP、SOAP等。通过这些成熟的协议，ACS和用户设备之间可以方便地建立通信的基本通道。TR-069在SOAP之上定义了用于配置、查询、诊断等操作的特定的RPC方法，通信的两端（ACS和用户设备）都可以通过RPC调用来完成某个特定功能的执行和得到返回的结果。

- - 用户设备和ACS之间的通信分为ACS发现阶段和连接建立阶段。在ACS发现阶段，用户设备需要得知ACS的URL或地址，这些信息可以是预配置在用户设备中的，也可以通过DHCP的选项来传送给用户设备。一旦用户设备得到ACS的URL或地址，用户设备可以在任何时候发起对ACS的连接。

- - 在连接过程中，用户设备作为HTTP的客户端，其SOAP请求通过HTTPPOST发送给ACS；而ACS作为HTTP的服务端，其SOAP请求通过HTTPResponse发送给用户设备。在每一个HTTP请求中可以包含多个SOAP请求或响应。为了确保管理配置系统的安全，TR-069建议使用SSL/TLS对用户设备进行认证。如果不使用SSL/TLS，也应使用HTTP1．1中定义的认证方式对用户设备进行认证。

- - 除了上面提到的方式，TR-069还明确了ACS可以向用户设备发起连接请求的规定，用于完成网络侧发起的异步配置动作等。
